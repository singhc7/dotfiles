# --- PRIORITY SORTING ---

# 1. Prefer VP9 (vcodec:vp9)
# 2. If no VP9, prefer H.264 (vcodec:h264)
# 3. Sort by Resolution (res) and Frame Rate (fps)
# This forces it to pick the 4K VP9 stream over the 4K AV1 stream.
-S vcodec:vp9,vcodec:h264,res,fps

# --- CONTAINER ---

# Keep the native WebM container (YouTube standard for VP9).
# Do not convert/merge unless necessary.
--prefer-free-formats

# --- METADATA & ARCHIVING ---

# Embed the YouTube thumbnail into the file icon
--embed-thumbnail

# Embed metadata (upload date, description, uploader name)
--embed-metadata

# Embed chapters (if the video has them)
--embed-chapters

# --- SUBTITLES (SAFE MODE) ---

# If subtitles fail (429 error), SKIP them and keep downloading the video.
--ignore-errors

# Download English subtitles (prioritize manual, fallback to auto)
--write-sub
--write-auto-sub

# Only ask for standard English, not every dialect (prevents 429 spam)
--sub-lang "en,en-US"

# Embed them if successful
--embed-subs

# Sleep 1-3 seconds between subtitle requests to avoid IP bans
--sleep-subtitles 2

# --- CLEAN FILENAMES ---

# Rename files to: "Title [Resolution] [ID].ext"
# Removes weird characters, making them easier to manage in terminal.
-o "%(title)s [%(height)s] [%(id)s].%(ext)s"
